[Вопросы для собеседования](designmenu.md)

# CAP-теорема
+ [Определение](#Определение)
+ [Следствия](#Следствия)
+ [BASE-архитектура](#BASE-архитектура)


## Определение

**Теорема CAP** (теорема Брюера) — эвристическое утверждение о том, что в любой реализации распределённых вычислений 
возможно обеспечить не более двух из трёх следующих свойств:

+ Согласованность данных (consistency) — во всех вычислительных узлах в один момент времени данные не противоречат друг другу;
+ Доступность (availability) — любой запрос к распределённой системе завершается корректным откликом, 
однако без гарантии, что ответы всех узлов системы совпадают;
+ Устойчивость к разделению (partition tolerance) — расщепление распределённой системы на 
несколько изолированных секций не приводит к некорректности отклика от каждой из секций.

[к оглавлению](#CAP-теорема)


## Следствия

Распределённые системы вычислений в зависимости от пары практически поддерживаемых свойств из трёх возможных 
распадаются на три класса — CA, CP, AP (при этом в рамках одной программной системы могут быть реализованы 
стратегии обработки различных запросов с использованием различных систем вычислений).

+ **CA** во всех узлах данные согласованы и обеспечена доступность, при этом она жертвует устойчивостью к распаду на секции. 
Такие системы возможны на основе технологического программного обеспечения, поддерживающего транзакционность в смысле ACID, 
примерами реализации таких систем вычислений могут быть решения на основе кластерных СУБД или распределённая служба каталогов LDAP;
+ **CP** в каждый момент обеспечивает целостный результат и способна функционировать в условиях распада, 
но достигает этого в ущерб доступности: может не выдавать отклик на запрос. Устойчивость к распаду на секции 
требует обеспечения дублирования изменений во всех узлах программной системы, реализующей данную систему вычислений, 
в связи с этим отмечается практическая целесообразность использования в таких системах распределённых пессимистических 
блокировок для сохранения целостности;
+ **AP** не гарантирует целостность, но при этом выполнены условия доступности и устойчивости к распаду на секции. 
Реализации систем вычислений такого рода - например, распределённые веб-кэши или DNS). Также, большинство NoSQL-систем 
принципиально не гарантируют целостности данных, и ссылаются на теорему CAP как на мотив такого ограничения. 
Задачей при построении AP-систем становится обеспечение некоторого практически целесообразного уровня целостности данных, 
в этом смысле про AP-системы говорят как о «целостных в конечном итоге» (eventually consistent)
или как о «слабо целостных» (weak consistent).

[к оглавлению](#CAP-теорема)

## BASE-архитектура

Распределённые системы, в которых требования целостности и доступности выполнены не в полной мере, может использоваться 
подход BASE (Basically Available, Soft-state, Eventually consistent — базовая доступность, неустойчивое состояние, 
согласованность в конечном счёте), при этом такой подход напрямую противопоставляется ACID. 
+ Базовая доступность - подход к проектированию приложения, чтобы сбой в некоторых узлах приводил к отказу в обслуживании 
только для незначительной части сессий при сохранении доступности в большинстве случаев;
+ Неустойчивое состояние - подразумевает возможность жертвовать долговременным хранением состояния сессий (таких как 
промежуточные результаты выборок, информация о навигации, контексте), при этом концентрируясь на фиксации обновлений только 
критичных операций. 
+ Согласованность в конечном счёте - возможность противоречивости данных в некоторых случаях, но при обеспечении 
согласования в практически обозримое время.

[к оглавлению](#CAP-теорема)

[Вопросы для собеседования](designmenu.md)
